\usepackage{scrlayer-scrpage}
\usepackage{needspace}
\usepackage{titlesec}
\usepackage{ccicons}
\usepackage{fontawesome5}
\usepackage{marginnote}
\usepackage{sidenotes}
\usepackage{booktabs}
\usepackage{pdfpages}
%\usepackage[defaultlines=2,all]{nowidow}
%\usepackage{ragged2e}
\raggedbottom

\usepackage{xcolor}
\definecolor{OffBlack}{HTML}{191919}
\definecolor{Maroon}{HTML}{800000}
\definecolor{HopkinsBlue}{HTML}{002D72}
\definecolor{RacingGreen}{HTML}{004225}
\definecolor{LightGrey}{HTML}{d5d8dc}
\definecolor{PenguinRed}{HTML}{e23e35}

\usepackage{fontspec}
%\setmainfont{Literata}[Mapping=tex-text]
%\setsansfont{Adelle Sans}[Mapping=tex-text]
\setmainfont{Literata-Light.ttf}[
	Path           = fonts/ ,
    BoldFont       = Literata-Regular.ttf ,
    ItalicFont     = Literata-LightItalic.ttf ,
    BoldItalicFont = Literata-Italic.ttf ]
\setsansfont{adelle-sans-light.otf}[
	Path           = fonts/ ,
    BoldFont       = adelle-sans-semibold.otf ,
    ItalicFont     = adelle-sans-light-italic.otf ,
    BoldItalicFont = adelle-sans-italic.otf ]
\setmonofont[Scale=0.90]{LFT Etica Mono}

\newfontface\coverfont{FrutigerCE-Roman.ttf}[
	Path           = fonts/ ,
    BoldFont       = FrutigerCE-Black.ttf ,
    ItalicFont     = FrutigerCE-Italic.ttf ,
    BoldItalicFont = FrutigerCE-BoldItalic.ttf ]

% font style & text alignment for margin notes
\renewcommand{\marginfont}{\color{RacingGreen}\sffamily\scriptsize}
\renewcommand*{\raggedleftmarginnote}{\raggedright}

% smaller sizes for footnotes & captions
\renewcommand{\footnotesize}{\scriptsize}
\renewcommand{\captionsize}{\small}

% smaller font size, more space between rows, for tables 
\newcommand{\tablefont}{\footnotesize} 
\AtBeginEnvironment{tabular}{\tablefont}
\AtBeginEnvironment{tabular*}{\tablefont} 
\AtBeginEnvironment{longtable}{\tablefont}
\AtBeginEnvironment{longtable*}{\tablefont} 
\renewcommand{\arraystretch}{2}

% custom unordered list environment for statutes and other legal code
\usepackage{enumitem}

\setlist[itemize]{label=\textbullet}

\newenvironment{legalcode}{%
  \setlist[itemize]{
    label={},
    itemindent=0em,
    leftmargin=1em,
  }
  \renewcommand{\labelitemi}{}
  \renewcommand{\tightlist}{\setlength{\topsep}{0em}\setlength{\partopsep}{.5em}\setlength{\itemsep}{.5em}\setlength{\parskip}{0em}}}

%=== Chapter & Section Headings ===
\titlespacing*{\chapter}{0em}{50mm}{0mm}
\titlespacing*{\section}{0mm}{0mm}{3mm}
\titlespacing*{\subsection}{0mm}{6mm}{0mm}
\titlespacing*{\subsubsection}{0mm}{3mm}{0mm}
\titlespacing*{\paragraph}{0mm}{3mm}{0mm}

\titleformat{\chapter}
  [block]
  {\raggedright\sffamily\huge\color{Maroon}}
  {Chapter \thechapter ~~}
  {0em}
  {}
  []

\titleformat{\section}
  [block]
  {\clearpage\raggedright\rmfamily\LARGE\color{Maroon}}
  {\thesection ~~}
  {0em}
  {}
  []

% Case, statute, rule, etc. title
\titleformat{\subsection}
  [block]
  {\needspace{9\baselineskip}\raggedright\rmfamily\Large\color{Maroon}}
  {\thesubsection ~~}
  {0em}
  {}
  [\vspace{-1.3em}\textcolor{Maroon}{\rule{\textwidth}{.5pt}}]

% Case - Judge Name
\titleformat{\subsubsection}
  [block]
  {\needspace{3\baselineskip}\raggedright\rmfamily\normalsize\bfseries}
  {\thesubsubsection ~~}
  {0em}
  {}
  []

\titleformat{\paragraph}
  [block]
  {\needspace{3\baselineskip}\raggedright\rmfamily\normalsize\itshape}
  {\theparagraph}
  {0em}
  {}
  []

% Case, etc. first heading
\newcommand{\casesection}[1]{\needspace{4\baselineskip}\vspace{.5em}\begin{center}\rmfamily\normalsize{\bfseries{#1}}\end{center}}
% Case, etc. second heading
\newcommand{\casesubsection}[1]{\needspace{2\baselineskip}\begin{center}\rmfamily\normalsize{\itshape{#1}}\end{center}}
% Case, etc. third heading
\newcommand{\casesubsubsection}[1]{\needspace{2\baselineskip}\begin{center}\rmfamily\normalsize{#1}\end{center}}

%\graphicspath{{../img/}}
\renewcommand*{\figureformat}{}
\renewcommand*{\captionformat}{}

\newcommand{\openepigraph}[3]{ 
{\noindent{\color{Maroon}{\Large\faQuoteLeft}}\hspace{.5em}\rmfamily\normalsize
{\itshape{#1}}
\begin{flushright}\noindent{\color{Maroon}{\faPenNib}} ~{#2}, {\itshape{#3}} \end{flushright}}
}

\renewenvironment{quote}{
  \list{}{\leftmargin=2em\rightmargin=2em}
  \item\relax\small
}
{\endlist}

\newcommand{\monthyear}{%
  \ifcase\month\or January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
  December\fi\space\number\year
}

\newcommand{\blankpage}{\newpage\hbox{}\thispagestyle{empty}\newpage}